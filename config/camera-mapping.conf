# Camera Recorder Configuration
# Edit these settings to match your hardware and preferences

#===========================================
# Camera Device Mapping
#===========================================

# Camera 1 - Primary camera (usually /dev/video0)
CAMERA1_DEVICE="/dev/video0"
CAMERA1_NAME="Primary Camera"
CAMERA1_RESOLUTION="3840x2160"    # 4K resolution
CAMERA1_FRAMERATE="60"            # FPS
CAMERA1_FORMAT="h264"             # Input format: h264, mjpeg, yuyv

# Camera 2 - Secondary camera (usually /dev/video2 due to companion devices)  
CAMERA2_DEVICE="/dev/video2"
CAMERA2_NAME="Secondary Camera"
CAMERA2_RESOLUTION="3840x2160"    # 4K resolution
CAMERA2_FRAMERATE="60"            # FPS
CAMERA2_FORMAT="h264"             # Input format: h264, mjpeg, yuyv

#===========================================
# Video Encoding Settings (Intel QSV)
#===========================================

# QSV Encoding preset: veryfast, fast, medium, slow, veryslow
# Fast preset for better motion handling (conveyor belt application)
ENCODING_PRESET="fast"

# Quality setting (18-32, lower = better quality, higher file size)
# 23 provides high quality for detailed particle tracking
# Lower values preserve more detail for fast-moving particles
ENCODING_QUALITY="23"

# Alternative: Use H.264 instead of H.265 for better compatibility
# Uncomment the line below to switch to H.264
# ENCODING_CODEC="h264_qsv"
ENCODING_CODEC="hevc_qsv"

# Enable lookahead for better quality (0=off, 1=on)
# Lookahead helps with fast motion and detail preservation
LOOKAHEAD_ENABLED="1"

# Bitrate mode for conveyor belt recording
# Using VBR (Variable Bit Rate) for better quality in high-detail scenes
BITRATE_MODE="VBR"
TARGET_BITRATE="15000"      # 15 Mbps per camera for high detail
MAX_BITRATE="20000"         # 20 Mbps maximum for peak detail scenes

# GOP (Group of Pictures) size - smaller for better seeking and less motion blur
# 30 = 1 keyframe every second at 30fps, 60 = every second at 60fps
GOP_SIZE="60"

# Reference frames for better motion estimation
REF_FRAMES="3"

#===========================================
# Recording Settings
#===========================================

# Segment length in seconds (60 = 1 minute, 3600 = 1 hour)
SEGMENT_TIME="60"

# Video container format
CONTAINER_FORMAT="mp4"

# Disk write optimization (reduces I/O frequency)
FLUSH_PACKETS="0"                           # 0 = buffer writes, 1 = immediate flush
MOVFLAGS="faststart+frag_keyframe"          # MP4 optimization flags

#===========================================
# Storage Configuration
#===========================================

# Base directory for recordings
RECORDINGS_BASE="/storage/recordings"

# Cleanup settings
CLEANUP_ENABLED="true"
CLEANUP_DAYS="30"              # Keep recordings for 30 days
DISK_USAGE_THRESHOLD="95"      # Stop recording when disk usage exceeds 95%

# Directory structure:
# ${RECORDINGS_BASE}/
# ├── cam1/                    # Camera 1 recordings
# ├── cam2/                    # Camera 2 recordings  
# └── logs/                    # Log files

#===========================================
# Performance Tuning
#===========================================

# Extra hardware frames for QSV (increase if you see frame drops)
EXTRA_HW_FRAMES="64"

# Buffer size for input (in KB, 0 = default)
INPUT_BUFFER_SIZE="0"

# Thread count (0 = auto-detect)
THREAD_COUNT="0"

#===========================================
# Monitoring and Alerting
#===========================================

# Enable disk space monitoring (true/false)
DISK_MONITORING="true"

# Check interval in seconds
MONITORING_INTERVAL="300"      # Check every 5 minutes

# Low space warning threshold (percentage)
LOW_SPACE_WARNING="85"

#===========================================
# Network and Remote Access
#===========================================

# Enable simple web interface for log viewing (true/false)
WEB_INTERFACE="true"

# Web interface port (if enabled)
WEB_PORT="8080"

# Allow remote access via specified network (CIDR notation)
# Example: "192.168.1.0/24" for local network only
# "0.0.0.0/0" allows access from anywhere (use with caution)
ALLOWED_NETWORKS="0.0.0.0/0"

#===========================================
# Advanced Settings
#===========================================

# Custom FFmpeg options (advanced users only)
# Leave empty for defaults
CUSTOM_FFMPEG_OPTS=""

# Force specific VA-API driver (iHD recommended for Intel N100)
VAAPI_DRIVER="iHD"

# Enable debug logging (true/false) 
DEBUG_LOGGING="false"
